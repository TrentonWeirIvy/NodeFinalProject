<!DOCTYPE html>
<html lang="en">
<%- include("./partials/head.ejs") %>

<body>
  <%- include("./partials/nav.ejs") %>

  <div class="container">
    <h2>Welcome to Group Pidgeon's Website</h2>

    <div class="container">
      <h4>Teachers</h4>
     <section class="teachers">
      
      </section>
    </div>
    
      <div class="container">
        <h4>Courses</h4>
    
        <section class="courses">
          
        </section>
      </div>
    </section>
  </div>

  <%- include("./partials/footer.ejs") %>

  <script src="./createTable.js"></script>

  <script>


    const setUpCourseTable = async () => {
      await axios.get('./api/courses').then(async courses => {
        const table = await createTable(courses.data,true);
        const container = document.querySelector('.courses');
        table.querySelectorAll('tr').forEach(async row => {
          const id = row.dataset.id;
          row.addEventListener('click', () => {
            window.location.assign(window.location.origin + '/teacherForm/' + id);
          });
        });
        container.append(table);
      })
      .catch(e => console.error(e));
    }
    setUpCourseTable();

    const setUpUsersCourses = async () => {
      const userToken = JSON.parse(localStorage.getItem('User')).token;
      console.log(userToken);
    
      await axios.get('./api/getUserById', { params: { user: userToken } })
        .then(res => res.data)
        .then(data => console.log(data))
        .catch(e => console.error(e));
    };
    
  
  setUpUsersCourses();
    
  </script>
</body>
</html>
